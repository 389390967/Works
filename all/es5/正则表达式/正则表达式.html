<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>正则表达式/规则表达式</title>
    <link rel="shortcut icon" href="../../../img/ico.ico">
    <link rel="stylesheet" href="../../../css/common.css">
    <style>
        table {
            margin: 0 15px;
        }
    </style>
</head>

<body>
    <h1>正则/规则表达式</h1>
    <ul class="note">
        <li>解释：规则表达式就是用于描述规则的工具。换句话说，规则表达式就是记录文本规则的代码。</li>
        <li class="flex-space-between margin-hor--15 margin-bottom-20">
            <table>
                <thead>
                    <tr>
                        <th colspan='2'>常用元字符</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>\w</td>
                        <td>(word)匹配字母或数字或下划线[a-z0-9_]</td>
                    </tr>
                    <tr>
                        <td>\s</td>
                        <td>(space)匹配任意的空白符[\t\n\x0B\f\r]</td>
                    </tr>
                    <tr>
                        <td>\d</td>
                        <td>(digital)匹配数字[0-9]</td>
                    </tr>
                    <tr>
                        <td>\b</td>
                        <td>匹配单词的开始或结束(单词边界)</td>
                    </tr>
                    <tr>
                        <td>.</td>
                        <td>匹配除换行符以外的任意字符[^\n\r]</td>
                    </tr>
                    <tr>
                        <td>^</td>
                        <td>匹配字符串的开始(以什么开始)</td>
                    </tr>
                    <tr>
                        <td>$</td>
                        <td>匹配字符串的结束</td>
                    </tr>
                </tbody>
            </table>

            <table>
                <thead>
                    <tr>
                        <th colspan='2'>常用反义词</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>\W</td>
                        <td>匹配任意不是字母，数字，下划线，汉字的字符[^a-z0-9_]</td>
                    </tr>
                    <tr>
                        <td>\S</td>
                        <td>匹配任意不是空白符的字符</td>
                    </tr>
                    <tr>
                        <td>\D</td>
                        <td>匹配任意非数字的字符[^0-9]</td>
                    </tr>
                    <tr>
                        <td>\B</td>
                        <td>匹配不是单词开头或结束的位置</td>
                    </tr>
                    <tr>
                        <td>[^a]</td>
                        <td>匹配除了a以外的任意字符</td>
                    </tr>
                    <tr>
                        <td>[^asdfg]</td>
                        <td>匹配除了asdfg这几个字母以外的任意字符</td>
                    </tr>
                </tbody>
            </table>

            <table>
                <thead>
                    <tr>
                        <th colspan='2'>不常用元字符</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>\t</td>
                        <td>水平制表符</td>
                    </tr>
                    <tr>
                        <td>\v</td>
                        <td>垂直制表符</td>
                    </tr>
                    <tr>
                        <td>\n</td>
                        <td>换行符</td>
                    </tr>
                    <tr>
                        <td>\r</td>
                        <td>回车符</td>
                    </tr>
                    <tr>
                        <td>\0</td>
                        <td>空字符</td>
                    </tr>
                    <tr>
                        <td>\f</td>
                        <td>换页符</td>
                    </tr>
                    <tr>
                        <td>\cX</td>
                        <td>与X对应的控制字符</td>
                    </tr>
                </tbody>
            </table>
        </li>

        <li class="flex-space-between margin-hor--15">
            <table>
                <thead>
                    <tr>
                        <th colspan='2'>常用限定符</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>*</td>
                        <td>重复零次或更多次{0,}</td>
                    </tr>
                    <tr>
                        <td>+</td>
                        <td>重复一次或更多次{1,}</td>
                    </tr>
                    <tr>
                        <td>?</td>
                        <td>重复零次或一次{0,1}</td>
                    </tr>
                    <tr>
                        <td>{n}</td>
                        <td>重复n次</td>
                    </tr>
                    <tr>
                        <td>{n,}</td>
                        <td>重复n次或更多次</td>
                    </tr>
                    <tr>
                        <td>{n,m}</td>
                        <td>重复n到m次</td>
                    </tr>
                </tbody>
            </table>

            <table>
                <thead>
                    <tr>
                        <th colspan='2'>匹配选项</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>i</td>
                        <td>ignore 忽略大小写匹配</td>
                    </tr>
                    <tr>
                        <td>g</td>
                        <td>global 全局匹配</td>
                    </tr>
                    <tr>
                        <td>m</td>
                        <td>multiple lines 多行匹配</td>
                    </tr>
                </tbody>
            </table>
        </li>
        <li><a href="https://regexper.com/">网站：正则表达式工具</a></li>
    </ul>

    <div class="ctn">
        <pre id="pre"></pre>
    </div>

    <div class="ctn padding-ver-15">
        <table>
            <thead>
                <tr>
                    <th colspan='5'>分析方法————以邮箱为例</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>一串字母、数字、下划线</td>
                    <td>@</td>
                    <td>一串字母、数字</td>
                    <td>.</td>
                    <td>一串字母（最少2个、最多4个）</td>
                </tr>
                <tr>
                    <td>\w+</td>
                    <td>@</td>
                    <td>[a-z][0-9]+</td>
                    <td>.</td>
                    <td>[a-z]{2,4}</td>
                </tr>
                <tr>
                    <td colspan='5'>/\w+@[a-z0-9]+\.[a-z]{2,4}/</td>
                </tr>
            </tbody>
        </table>
    </div>
    <script src="../../../js/common.js"></script>
    <script id="jsCo">
        T('一、声明');
        {
            var re = new RegExp('a', 'i'); // js风格
            var re = /a/i; // perl风格
        }
        console.hr('----------分割线----------');

        T('二、匹配选项');
        T('1、全局匹配符 g');
        {
            var str = 'He is Blue. She is Red. This is a cat.';
            var reg = /is/;
            str = str.replace(reg, 'IS');
            console.log(str);

        }

        {
            var str = 'He is Blue. She is Red. This is a cat.';
            var reg = /is/g;
            str = str.replace(reg, 'IS');
            console.log(str);

        }
        // 如果没有用全局匹配符 g 匹配到第一个符合条件的就不再往下匹配了
        console.hr('----------分割线----------');

        T('三、常用元字符');
        T('1、\b 匹配单词的开始或结束(单词边界)');
        {
            var str = 'He is Blue. She is Red. This is a cat.';
            var reg = /is/g;
            str = str.replace(reg, 'IS');
            console.log(str);

        }

        {
            var str = 'He is Blue. She is Red. This is a cat.';
            var reg = /\bis\b/g;
            str = str.replace(reg, 'IS');
            console.log(str);
        }
        // 没有用 \b 的时候，会连 This 中的 is 都会被替换
        console.hr('----------分割线----------');

        T('四、贪婪模式和非贪婪模式');
        T('1、贪婪模式');
        {
            var str = '12345678';
            var reg = /\d{3,6}/g
            str = str.replace(reg, 'N');
            console.log(str);
        }
        //贪婪模式：会将量词的条件匹配到最大所以这里是 123456 符合条件

        T('2、非贪婪模式：在量词后面加 ？');
        {
            var str = '12345678';
            var reg = /\d{3,6}?/g
            str = str.replace(reg, 'N');
            console.log(str);
        }
        // 非贪婪模式：满足量词的最小条件后则不再匹配，所以这里匹配到 123 后不再匹配下去，而是开始新的匹配 456
        console.hr('----------分割线----------');

        T('五、分组');
        T('1、基本应用');
        {
            var str = 'a1b2c3d4';
            var reg = /[a-z]\d{3}/g;
            str = str.replace(reg, 'X');
            console.log(str);
        }

        {
            var str = 'a1b2c3d4';
            var reg = /([a-z]\d){3}/g;
            str = str.replace(reg, 'X');
            console.log(str);
        }
        console.hr('----------分割线----------');

        T('2、与 |（或）的应用');
        {
            var result = 'EthanRica'.replace(/Ethan|Rica/g, 'X');
            console.log(result);

            var result = 'EthancaEthRica'.replace(/Eth(an|Ri)ca/g, 'X');
            console.log(result);

            var result = 'ByronsperByrCasper'.replace(/Byr(on|Ca)sper/g, 'X');
            console.log(result);

            var result = '一只猪一头猪'.replace(/一(头|只)猪/g, 'X');
            console.log(result);
        }
        console.hr('----------分割线----------');

        T('3、分组捕获');
        {
            var str = '2019-01-01';
            var reg = /(\d{4})-(\d{2})-(\d{2})/;
            str = str.replace(reg, '$1/$2/$3');
            console.log(str);
        }
        console.hr('----------分割线----------');

        T('4、忽略分组: (?:规则)');
        {
            var str = '2019-01-01';
            var reg = /(?:\d{4})-(\d{2})-(\d{2})/;
            str = str.replace(reg, '$1/$2/$3');
            console.log(str);
        }
        console.hr('----------分割线----------');

        T('5、前瞻: (?=规则/?!规则) 正则表达式从左往右解析文本，右为前，左为后');
        {
            var str = '1a2b3cxx*8*8';
            var reg = /\d(?=\w)/g;
            str = str.replace(reg, '哈');
            console.log(str);
        }
        // ()括号中前瞻部分不会被替换掉，它只是一个前瞻条件

        {
            var str = '1a2b3cxx*8*8';
            var reg = /\d(?!\w)/g;
            str = str.replace(reg, '哈');
            console.log(str);
        }
        console.hr('----------分割线----------');

        T('六、正则表达式的 test()方法 和 lastIndex属性');
        {
            var reg = /\w/g;
            for (let index = 0; index < 4; index++) {
                console.log(reg.lastIndex, reg.test('a'));
            }
        }
        /* --
            如上例：字符串长度是 1 的时候执行第一次 lastIndex 是 0；第二次的时候是 1；第三次是 0；第四次是 0；依次循环。
        -- */

        {
            var reg = /\w/g;
            while (reg.test('abcd')) {
                console.log(reg.lastIndex);
            }
        }

        /* --
            总结：
            1、正则表达式每次执行 test() 它的 lastIndex 都会改变。
            2、lastIndex 表示匹配项的下一个位置，即执行下一次匹配时的起始位置。
            3、如果正则表达式的模式不是 global，那么 lastIndex 会一直是0，只有使用了 g 标志时，lastIndex 才起作用。 
        --*/
        console.hr('----------分割线----------');

        T('七、exec()');
        {
            var reg1 = /\d(\w)\d/;
            var reg2 = /\d(\w)\d/g;
            var str = '!@1a2b3c4d5e6f'

            var result1 = reg1.exec(str);
            console.log(result1);

            var result2 = '';
            while (result2 = reg2.exec(str)) {
                console.log(result2);
            }

            /* --
                总结：
                调用正则表达式的exec(),如果匹配到结果返回一个数组，否则返回null
                ["1a2", "a", index: 2, input: "!@1a2b3c4d5e6f"]
                1、第一个元素是与正则表达式匹配的文本。
                2、第二个元素是第一个子表达式匹配的内容，即第一个分组（如果有的话）；
                第三个元素是第二个子表达式匹配的内容，即第二个分组（如果有的话）依次类推。
                3、index 是返回数组中，正则表达式匹配到第一个字符的位置。
            -- */
        }
        console.hr('----------分割线----------');

        T('八、正则表达式与 String 对象的方法配合使用');
        T('1、search()配合使用：返回与正则表达式匹配的子字符串的位置。忽视 g 全局匹配符');
        {
            var reg = /\d/g;
            var str = 'asd123';
            console.log('第一个数字的位置：' + str.search(reg));
        }

        T('简单应用：判断当前用的是什么浏览器');
        {
            if (window.navigator.userAgent.search(/firefox/i) != -1) {
                console.log('当前浏览器是：firefox');
            } else if (window.navigator.userAgent.search(/chrome/i) != -1) {
                console.log('当前浏览器是：chrome');
            } else if (window.navigator.userAgent.search(/msie 9/i) != -1) {
                console.log('当前浏览器是：IE9');
            }
        }
        console.hr('----------分割线----------');

        T('2、match()配合使用：将所有匹配结果以数组形式返回');
        {
            var reg = /\d/g;
            var str = 'asd e123 fdsa 456 789gg 123456789 ethan 159 11 99 88';
            console.log(str.match(reg));

            var reg = /\d{2}/g;
            var str = 'asd e123 fdsa 456 789gg 123456789 ethan 159 11 99 88';
            console.log(str.match(reg));

            var reg = /\d+/g;
            var str = '0 0 asd e123 fdsa 456 789gg 123456789 ethan 159 11 99 88';
            console.log(str.match(reg));

            var reg = /1[abc]2/g;
            var str = '1b2 1a2 abc 1c2 aaa';
            console.log(str.match(re));
        }
        console.hr('----------分割线----------');

        T('2、split()配合使用：将一个字符串拆分成一个数组');
        {
            var reg = /\d/g;
            var str = '1a2b3c4d5e6f'
            console.log(str.split(reg));
        }
        console.hr('----------分割线----------');

        T('2、replace()配合使用：将字符串中的某些子串替换为需要的内容');
        {
            var str = 'asdfASDF';
            console.log(str.replace(/a/gi, 'B'));
        }
        console.hr('----------分割线----------');

        T('九、实例应用');
        {
            T('1、去空格');
            var str = '  aa bb  cc   dd  ';
            console.log(str.replace(/\s+/g, ''));

            T('2、去首尾空格');
            var re = /^\s+|\s+$/g;
            var str = 'aa bb cc dd ';
            console.log(str.replace(re, ''));

            T('3、检验中文');
            var str = '哈哈 asdfgqwer 12 !@#$ *&^ +_=';
            var re = /[\u4e00-\u9fa5]/;
            console.log(re.test(str));

            var str = '哈哈 asdfgqwer 12 !@#$ *&^ +_=';
            var re = /^[\u4e00-\u9fa5]$/; // 加了^ $以后表示行首和行尾之间必须出现中文而且只能出现中文
            console.log(re.test(str));

            T('4、检验QQ');
            var re = /[1-9]\d{4,10}/g;
            var str = 'QQ：159753，QQ：159753，QQ：0-14753';
            console.log(str.match(re));

            T('5、检验邮箱');
            var re = /^\w+@[a-z0-9]+\.[a-z]{2,4}$/;
            var str = '159753@qq.com';
            console.log(re.test(str));
        }
        console.hr('----------分割线----------');
    </script>
    <script>
        appendJsCode('jsCo', 'pre');
    </script>
</body>

</html>